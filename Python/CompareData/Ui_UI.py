# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'd:\Development\MyTools\Python\CompareData\UI.ui'
#
# Created by: PyQt5 UI code generator 5.15.10
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtWidgets

import compare


class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(601, 680)
        self.v_1 = QtWidgets.QWidget(MainWindow)
        self.v_1.setObjectName("v_1")
        self.v_2 = QtWidgets.QVBoxLayout(self.v_1)
        self.v_2.setContentsMargins(9, -1, -1, -1)
        self.v_2.setSpacing(11)
        self.v_2.setObjectName("v_2")
        self.openfile_btn = QtWidgets.QPushButton(self.v_1)
        self.openfile_btn.setIconSize(QtCore.QSize(16, 16))
        self.openfile_btn.setObjectName("openfile_btn")
        self.v_2.addWidget(self.openfile_btn)
        self.code_edit = QtWidgets.QTextEdit(self.v_1)
        self.code_edit.setObjectName("code_edit")
        self.v_2.addWidget(self.code_edit)
        self.execute_btn = QtWidgets.QPushButton(self.v_1)
        self.execute_btn.setObjectName("execute_btn")
        self.v_2.addWidget(self.execute_btn)
        MainWindow.setCentralWidget(self.v_1)

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

        self.openfile_btn.clicked.connect(lambda: compare.openfile(self))
        self.execute_btn.clicked.connect(lambda: compare.execute(self, self.filepath, self.code_edit))

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "差额对比生成器"))
        self.openfile_btn.setText(_translate("MainWindow", "预览文件"))
        self.code_edit.setHtml(_translate("MainWindow",
                                          "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"
                                          "<html><head><meta name=\"qrichtext\" content=\"1\" /><style type=\"text/css\">\n"
                                          "p, li { white-space: pre-wrap; }\n"
                                          "</style></head><body style=\" font-family:\'SimSun\'; font-size:9pt; font-weight:400; font-style:normal;\">\n"
                                          "<p style=\" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#1e1f22;\"><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\"><br />grouped_platform_key = </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">药品统一编码</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">grouped_his_key = </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">国家医保编码</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">how_connect = </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'outer\'<br /><br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\"># </span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">招采数据<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">platform_data = data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">医院招采入库表</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">].astype({<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">医院采购价</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">(</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">元</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">)\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#8888c6;\">float</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">,<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">收货数量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#8888c6;\">float</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">,<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">退货数量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#8888c6;\">float</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">,<br />}).rename(</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#aa4926;\">columns</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">={<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">医院采购价</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">(</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">元</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">)\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">招采单价</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">,<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">收货数量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">招采入库量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">,<br />})<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\"># </span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">医院数据<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">his_data = data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">医院</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">入库表</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">].astype({<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">批发单价包装</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">(</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">小</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">)\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#8888c6;\">float</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">,<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">批发价合计金额（元）</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#8888c6;\">float<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">}).rename(</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#aa4926;\">columns</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">={<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">入库数量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">入库量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">,<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">批发单价包装</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">(</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">小</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">)\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">采购单价</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">,<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">批发价合计金额（元）</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">入库总额</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">,<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">项目名称</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">产品名称</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">})<br /><br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\"># </span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">入库量和入库总额计算<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">platform_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">招采入库量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">] = platform_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">招采入库量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">] - platform_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">退货数量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">]<br />platform_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">招采入库总额</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">] = platform_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">招采单价</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">] * platform_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">招采入库量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">]<br />his_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">入库量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">] = his_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">入库量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">].apply(utils.get_num)<br /><br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\"># </span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">动态代码，选择 招采</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\"> agg </span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">字段的方式<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">agg_platform_data = platform_data.groupby(grouped_platform_key).agg({<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">产品名称</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'first\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">, grouped_platform_key: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'first\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">转换比</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'first\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">招采单价</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'first\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">招采入库量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'sum\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">,<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">招采入库总额</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'sum\'<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">})<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\"># </span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">动态代码，选择</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\"> HIS agg </span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">字段的方式<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">agg_his_data = his_data.groupby(grouped_his_key).agg({<br />    </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">产品名称</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'first\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">, grouped_his_key: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'first\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">采购单价</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'first\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">入库量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'sum\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">入库总额</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'sum\'<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">})<br /><br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\"># </span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">连接两表<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">agg_platform_data.reset_index(</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#aa4926;\">drop</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">=</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#cf8e6d;\">True</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#aa4926;\">inplace</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">=</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#cf8e6d;\">True</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">)<br />agg_his_data.reset_index(</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#aa4926;\">drop</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">=</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#cf8e6d;\">True</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#aa4926;\">inplace</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">=</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#cf8e6d;\">True</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">)<br />merged_data = pd.merge(agg_platform_data, agg_his_data,<br />                       </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#aa4926;\">how</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">=how_connect, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#aa4926;\">indicator</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">=</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#cf8e6d;\">True</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">,<br />                       </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#aa4926;\">left_on</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">=grouped_platform_key,<br />                       </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#aa4926;\">right_on</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">=grouped_his_key)<br /><br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\"># </span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">计算差额表采购量差和金额差<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">merged_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">采购量差额</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">] = merged_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">招采入库量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">] - merged_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">入库量</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">]<br />merged_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">采购金额差</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">] = (<br />    (merged_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">招采入库总额</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">] - merged_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">入库总额</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">]).apply(</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#cf8e6d;\">lambda </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">x: utils.reserve(x, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#2aacb8;\">4</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">)))<br /><br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\"># inner </span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">不需要这一行，</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">outer </span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">需要这一行<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">merged_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'_merge\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">] = merged_data[</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'_merge\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">].replace(<br />    {</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'left_only\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">仅招采有</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'right_only\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">仅</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">HIS</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">有</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'both\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">: </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">两者匹配</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#6aab73;\">\'</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">})<br /><br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\"># </span><span style=\" font-family:\'宋体\',\'monospace\'; font-size:9.8pt; color:#7a7e85;\">输出文件<br /></span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">merged_data.to_excel(output_path, </span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#aa4926;\">index</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">=</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#cf8e6d;\">False</span><span style=\" font-family:\'JetBrains Mono\',\'monospace\'; font-size:9.8pt; color:#bcbec4;\">)</span></p></body></html>"))
        self.execute_btn.setText(_translate("MainWindow", "开始执行"))
